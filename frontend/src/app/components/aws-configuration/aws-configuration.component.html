<div class="aws-config-container">
  <p-toast></p-toast>
  
  <!-- Header -->
  <div class="config-header">
    <h2 class="header-title">AWS Configuration</h2>
    <p class="header-subtitle">Environment-controlled AWS Bedrock connection</p>
  </div>

  <!-- Connection Status Card -->
  <div class="status-card" [ngClass]="getStatusCardClass()">
    <div class="status-header">
      <div class="status-icon">
        <i [class]="getStatusIcon()"></i>
      </div>
      <div class="status-info">
        <h3 class="status-title">{{ getStatusTitle() }}</h3>
        <p class="status-message">{{ getStatusMessage() }}</p>
      </div>
      <div class="refresh-button">
        <p-button 
          icon="pi pi-refresh" 
          [loading]="loading"
          (onClick)="refreshStatus()"
          severity="secondary"
          size="small"
          [text]="true">
        </p-button>
      </div>
    </div>

    <!-- Connection Details (when connected) -->
    <div class="connection-details" *ngIf="awsStatus?.connected">
      <div class="detail-grid">
        <div class="detail-item">
          <span class="detail-label">Account ID</span>
          <span class="detail-value">{{ awsStatus?.account_id || 'N/A' }}</span>
        </div>
        <div class="detail-item">
          <span class="detail-label">Region</span>
          <span class="detail-value">{{ awsStatus?.region || 'N/A' }}</span>
        </div>
        <div class="detail-item">
          <span class="detail-label">Auth Method</span>
          <span class="detail-value">{{ getAuthMethodDisplay() }}</span>
        </div>
        <div class="detail-item">
          <span class="detail-label">Available Models</span>
          <span class="detail-value">{{ awsStatus?.available_models_count || 0 }}</span>
        </div>
      </div>
    </div>

    <!-- Error Details (when error) -->
    <div class="error-details" *ngIf="awsStatus?.error">
      <div class="error-message">
        <i class="pi pi-exclamation-triangle"></i>
        <span>{{ awsStatus?.error }}</span>
      </div>
    </div>
  </div>

  <!-- Current Model Card -->
  <div class="model-card" *ngIf="currentModel">
    <div class="model-header">
      <div class="model-icon">
        <i class="pi pi-cpu"></i>
      </div>
      <div class="model-info">
        <h3 class="model-name">{{ currentModel.name }}</h3>
        <p class="model-provider">{{ currentModel.provider }}</p>
        <p class="model-description">{{ currentModel.description }}</p>
      </div>
    </div>
  </div>

  <!-- Configuration Instructions Card -->
  <div class="instructions-card">
    <div class="instructions-header">
      <i class="pi pi-cog"></i>
      <h3>AWS Configuration Instructions</h3>
    </div>
    
    <div class="instructions-content">
      <p class="instructions-intro">
        AWS credentials are managed through environment variables in your <code>.env</code> file. 
        Choose one of the authentication methods below:
      </p>

      <!-- Access Keys Method -->
      <div class="auth-method">
        <h4 class="method-title">
          <i class="pi pi-key"></i>
          Method 1: Access Keys
        </h4>
        <p class="method-description">Use AWS access key and secret key for authentication.</p>
        
        <div class="env-variables">
          <div class="env-var">
            <code>AWS_ACCESS_KEY_ID=AKIA...</code>
          </div>
          <div class="env-var">
            <code>AWS_SECRET_ACCESS_KEY=your-secret-key</code>
          </div>
          <div class="env-var optional">
            <code>AWS_SESSION_TOKEN=your-session-token</code>
            <span class="optional-label">(optional, for temporary credentials)</span>
          </div>
          <div class="env-var">
            <code>AWS_REGION=us-east-1</code>
          </div>
        </div>
      </div>

      <!-- SSO Profile Method -->
      <div class="auth-method">
        <h4 class="method-title">
          <i class="pi pi-user"></i>
          Method 2: SSO Profile
        </h4>
        <p class="method-description">Use AWS CLI SSO profile for authentication.</p>
        
        <div class="env-variables">
          <div class="env-var">
            <code>AWS_PROFILE=your-sso-profile</code>
          </div>
          <div class="env-var">
            <code>AWS_REGION=us-east-1</code>
          </div>
        </div>
      </div>

      <!-- Model Configuration -->
      <div class="auth-method">
        <h4 class="method-title">
          <i class="pi pi-cpu"></i>
          Model Configuration
        </h4>
        <p class="method-description">Configure which Bedrock model to use.</p>
        
        <div class="env-variables">
          <div class="env-var" *ngIf="currentModel">
            <code>BEDROCK_MODEL_ID={{currentModel.id}}</code>
          </div>
          <div class="env-var" *ngIf="!currentModel">
            <code>BEDROCK_MODEL_ID=anthropic.claude-3-sonnet-20240229-v1:0</code>
            <small class="text-muted">Example model ID - configure based on your requirements</small>
          </div>
        </div>
      </div>

      <!-- Restart Notice -->
      <div class="restart-notice">
        <i class="pi pi-info-circle"></i>
        <div class="restart-content">
          <strong>Important:</strong> After updating your <code>.env</code> file, restart the application 
          for changes to take effect. Click the refresh button above to check your connection status.
        </div>
      </div>
    </div>
  </div>
</div>